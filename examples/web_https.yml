'@Kind': github.com/wzshiming/pipe/pipe/once.Once@config
Components:
- '@Kind': github.com/wzshiming/pipe/pipe/service.Service@multi
  '@Name': server
  Multi:
  - '@Kind': github.com/wzshiming/pipe/pipe/service.Service@stream
    Handler:
      '@Kind': github.com/wzshiming/pipe/pipe/stream.Handler@http
      Handler:
        '@Kind': net/http.Handler@log
        Handler:
          '@Ref': redirect
        Output:
          '@Kind': io.WriteCloser@file
          Path: /dev/stderr
      TLS: null
    Listener:
      '@Kind': github.com/wzshiming/pipe/pipe/stream/listener.ListenConfig@network
      Address: :80
      Network: tcp
  - '@Kind': github.com/wzshiming/pipe/pipe/service.Service@stream
    Handler:
      '@Kind': github.com/wzshiming/pipe/pipe/stream.Handler@http
      Handler:
        '@Kind': net/http.Handler@log
        Handler:
          '@Ref': page
        Output:
          '@Kind': io.WriteCloser@file
          Path: /dev/stderr
      TLS:
        '@Kind': github.com/wzshiming/pipe/pipe/tls.TLS@self_signed
    Listener:
      '@Kind': github.com/wzshiming/pipe/pipe/stream/listener.ListenConfig@network
      Address: :443
      Network: tcp
- '@Kind': net/http.Handler@redirect
  '@Name': redirect
  Code: 302
  Location: '{{.Scheme}}s://{{.Host}}{{.RequestURI}}'
- '@Kind': net/http.Handler@direct
  '@Name': page
  Body:
    '@Kind': io.ReadCloser@inline
    Data: <html><body>This is Pipe page {{.Scheme}}://{{.Host}}{{.RequestURI}}</body></html>
  Code: 200
Init: null
Pipe:
  '@Kind': github.com/wzshiming/pipe/pipe/service.Service@multi
  Multi:
  - '@Ref': server
