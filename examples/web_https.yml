'@Kind': sample@once.Once
Components:
- '@Kind': def@service.Service
  Def:
    '@Kind': multi@service.Service
    Multi:
    - '@Kind': stream@service.Service
      Handler:
        '@Kind': http@stream.Handler
        Handler:
          '@Kind': log@net/http.Handler
          Handler:
            '@Kind': ref@net/http.Handler
            Def: null
            Name: redirect
          Output:
            '@Kind': file@io.Writer
            Path: /dev/stderr
        TLS: null
      Listener:
        '@Kind': network@stream/listener.ListenConfig
        Address: :80
        Network: tcp
    - '@Kind': stream@service.Service
      Handler:
        '@Kind': http@stream.Handler
        Handler:
          '@Kind': log@net/http.Handler
          Handler:
            '@Kind': ref@net/http.Handler
            Def: null
            Name: page
          Output:
            '@Kind': file@io.Writer
            Path: /dev/stderr
        TLS:
          '@Kind': self_signed@tls.TLS
      Listener:
        '@Kind': network@stream/listener.ListenConfig
        Address: :443
        Network: tcp
  Name: server
- '@Kind': def@net/http.Handler
  Def:
    '@Kind': redirect@net/http.Handler
    Code: 302
    Location: '{{.Scheme}}s://{{.Host}}{{.RequestURI}}'
  Name: redirect
- '@Kind': def@net/http.Handler
  Def:
    '@Kind': direct@net/http.Handler
    Body:
      '@Kind': inline@io.Reader
      Data: <html><body>This is Pipe page {{.Scheme}}://{{.Host}}{{.RequestURI}}</body></html>
    Code: 200
  Name: page
Init: null
Pipe:
  '@Kind': multi@service.Service
  Multi:
  - '@Kind': def@service.Service
    Def: null
    Name: server
