'@Kind': Once@config
Components:
- '@Kind': Service@stream
  '@Name': gateway
  Handler:
    '@Kind': stream.Handler@http
    Handler:
      '@Kind': http.Handler@log
      Handler:
        '@Ref': weighted
      Output:
        '@Kind': Output@file
        Path: /dev/stderr
    TLS: null
  Listener:
    '@Kind': stream.ListenConfig@network
    Address: :80
    Network: tcp
- '@Kind': http.Handler@weighted
  '@Name': weighted
  Weighted:
  - Handler:
      '@Kind': http.Handler@direct
      Body:
        '@Kind': Input@inline
        Data: <html><body>This is Pipe page1 {{.Scheme}}://{{.Host}}{{.RequestURI}}</body></html>
      Code: 200
    Weight: 2
  - Handler:
      '@Kind': http.Handler@direct
      Body:
        '@Kind': Input@inline
        Data: <html><body>This is Pipe page2 {{.Scheme}}://{{.Host}}{{.RequestURI}}</body></html>
      Code: 200
    Weight: 8
Init: null
Pipe:
  '@Kind': Service@multi
  Multi:
  - '@Ref': gateway
