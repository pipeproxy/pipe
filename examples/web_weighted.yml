'@Kind': sample@once.Once
Components:
- '@Kind': def@service.Service
  Def:
    '@Kind': stream@service.Service
    Handler:
      '@Kind': http@stream.Handler
      Handler:
        '@Kind': log@net/http.Handler
        Handler:
          '@Kind': def@net/http.Handler
          Def: null
          Name: weighted
        Output:
          '@Kind': file@io.Writer
          Path: /dev/stderr
      TLS: null
    Listener:
      '@Kind': network@stream/listener.ListenConfig
      Address: :80
      Network: tcp
  Name: gateway
- '@Kind': def@net/http.Handler
  Def:
    '@Kind': weighted@net/http.Handler
    Weighted:
    - Handler:
        '@Kind': direct@net/http.Handler
        Body:
          '@Kind': inline@io.Reader
          Data: <html><body>This is Pipe page1 {{.Scheme}}://{{.Host}}{{.RequestURI}}</body></html>
        Code: 200
      Weight: 2
    - Handler:
        '@Kind': direct@net/http.Handler
        Body:
          '@Kind': inline@io.Reader
          Data: <html><body>This is Pipe page2 {{.Scheme}}://{{.Host}}{{.RequestURI}}</body></html>
        Code: 200
      Weight: 8
  Name: weighted
Init: null
Pipe:
  '@Kind': multi@service.Service
  Multi:
  - '@Kind': ref@service.Service
    Def: null
    Name: gateway
